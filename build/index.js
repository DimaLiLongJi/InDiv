parcelRequire=function(e,r,n,t){function i(n,t){function o(e){return i(o.resolve(e))}function c(r){return e[n][1][r]||r}if(!r[n]){if(!e[n]){var l="function"==typeof parcelRequire&&parcelRequire;if(!t&&l)return l(n,!0);if(u)return u(n,!0);if(f&&"string"==typeof n)return f(n);var p=new Error("Cannot find module '"+n+"'");throw p.code="MODULE_NOT_FOUND",p}o.resolve=c;var a=r[n]=new i.Module(n);e[n][0].call(a.exports,o,a,a.exports,this)}return r[n].exports}function o(e){this.id=e,this.bundle=i,this.exports={}}var u="function"==typeof parcelRequire&&parcelRequire,f="function"==typeof require&&require;i.isParcelRequire=!0,i.Module=o,i.modules=e,i.cache=r,i.parent=u;for(var c=0;c<n.length;c++)i(n[c]);if(n.length){var l=i(n[n.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):t&&(this[t]=l)}return i}({2:[function(require,module,exports) {
var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function r(){n(this,r),this.toString=Object.prototype.toString}return t(r,[{key:"getQuery",value:function(e){for(var t=window.location.search.replace("?","").split("&"),n={},r=0,o=t.length;r<o;r++){var i=t[r].split("=");n[i[0]]=i[1]}return n[e]?n[e]:""}},{key:"isFunction",value:function(e){return"[object Function]"===this.toString.call(e)}},{key:"isEqual",value:function(t,n,r,o){if(t===n)return 0!==t||1/t==1/n;if(null==t||null==n)return!1;if(t!=t)return n!=n;var i=void 0===t?"undefined":e(t);return("function"===i||"object"===i||"object"===(void 0===n?"undefined":e(n)))&&this.deepIsEqual(t,n,r,o)}},{key:"deepIsEqual",value:function(t,n,r,o){var i=this.toString.call(t);if(i!==this.toString.call(n))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+t==""+n;case"[object Number]":return+t!=+t?+n!=+n:0==+t?1/+t==1/n:+t==+n;case"[object Date]":case"[object Boolean]":return+t==+n}var u="[object Array]"===i;if(!u){if("object"!==(void 0===t?"undefined":e(t))||"object"!==(void 0===n?"undefined":e(n)))return!1;var c=t.constructor,a=n.constructor;if(c!==a&&!(this.isFunction(c)&&c instanceof c&&this.isFunction(a)&&a instanceof a)&&"constructor"in t&&"constructor"in n)return!1}r=r||[],o=o||[];for(var l=r.length;l--;)if(r[l]===t)return o[l]===n;if(r.push(t),o.push(n),u){if((l=t.length)!==n.length)return!1;for(;l--;)if(!this.isEqual(t[l],n[l],r,o))return!1}else{var s=Object.keys(t),f=void 0;if(l=s.length,Object.keys(n).length!==l)return!1;for(;l--;)if(f=s[l],!n.hasOwnProperty(f)||!this.isEqual(t[f],n[f],r,o))return!1}return r.pop(),o.pop(),!0}},{key:"setCookie",value:function(e,t,n){if(e&&t){var r=new Date;r.setDate(r.getDate()+n),document.cookie=e+"="+t+";expirse="+r}else console.error("set cookie error: key or value is null")}},{key:"getCookie",value:function(e){for(var t=document.cookie.split(";"),n=0;n<t.length;n++){var r=t[n].split("=");if(r[0]===e)return r[1]}return""}},{key:"removeCookie",value:function(e){this.setCookie(e,-1,-1)}}]),r}();module.exports=r;
},{}],3:[function(require,module,exports) {
var t=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=require("./Utils"),i=function(){function i(){e(this,i),this.declareTemplate="",this.state={},this.utils=new n}return t(i,[{key:"$onInit",value:function(){}},{key:"$beforeMount",value:function(){}},{key:"$afterMount",value:function(){}},{key:"$onDestory",value:function(){}},{key:"$hasRender",value:function(){}},{key:"$watchState",value:function(t,e){}},{key:"setState",value:function(t){if(t&&this.utils.isFunction(t)){var e=t();if(e&&e instanceof Object)for(var n in e)this.state[n]&&this.state[n]!==e[n]&&(this.state[n]=e[n])}if(t&&t instanceof Object)for(var i in t)this.state[i]&&this.state[i]!==t[i]&&(this.state[i]=t[i])}}]),i}();module.exports=i;
},{"./Utils":2}],4:[function(require,module,exports) {
var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=require("./Utils"),a=function(){function a(t,e,o,i){n(this,a),this.data=t,this.watcher=e,this.updater=o,this.render=i,this.watchData(this.data),this.utils=new r}return e(a,[{key:"watchData",value:function(e){if(e&&"object"===(void 0===e?"undefined":t(e))){var n=this,r=function(t){var r=e[t];n.watchData(r),Object.defineProperty(e,t,{configurable:!0,enumerable:!1,get:function(){return r},set:function(e){if(!n.utils.isEqual(e,r)){var a={};a[t]=r;var o={};o[t]=e,r=e,n.watchData(r),n.watcher&&n.watcher(a,o),n.updater&&n.updater(t,e),n.render&&n.render()}}})};for(var a in e)r(a)}}}]),a}();module.exports=a;
},{"./Utils":2}],5:[function(require,module,exports) {
var e=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function n(){t(this,n)}return e(n,[{key:"_getVMVal",value:function(e,t){var n=e;return t.replace("()","").split(".").forEach(function(e){"this"!==e&&(n=n[e])}),n}},{key:"_getVMRepeatVal",value:function(e,t,n){var a=void 0;return t.replace("()","").split(".").forEach(function(t){a=t!==n?a[t]:e}),a}},{key:"bind",value:function(e,t,n,a,i,r,l,o){var s=void 0;s=0===i.indexOf(n)||0===i.indexOf(n+".")?this._getVMRepeatVal(t,i,n):this._getVMVal(l,i);var c=this._getVMVal(l,o);this.text(e,t,n,l);var u=this[a+"Updater"];switch(a){case"model":u&&u.call(this,e,s,i,n,r,c,o,l);break;default:u&&u.call(this,e,s)}}},{key:"text",value:function(e,t,n,a){var i=e.textContent;if(/\{\{(.*)\}\}/g.test(i)){var r=RegExp.$1,l=void 0;l=0===r.indexOf(n)||0===r.indexOf(n+".")?this._getVMRepeatVal(t,r,n):this._getVMVal(a,r),this.textUpdater(e,l)}}},{key:"textUpdater",value:function(e,t){e.textContent=void 0===t?"":t}},{key:"htmlUpdater",value:function(e,t){e.innerHTML=void 0===t?"":t}},{key:"classUpdater",value:function(e,t,n){var a=e.className,i=(a=a.replace(n,"").replace(/\s$/,""))&&String(t)?" ":"";e.className=a+i+t}},{key:"modelUpdater",value:function(e,t,n,a,i,r,l,o){e.value=void 0===t?"":t;var s=n.replace(a+".","");e.addEventListener("change",function(){r[i][s]=e.value},!1)}},{key:"eventHandler",value:function(e,t,n,a){var i=a.split(":")[1],r=n.replace(/\(.*\)/,"").split("."),l=(n.match(/\((.*)\)/)[1].replace(/ /g,"").split(","),t);r.forEach(function(e){"this"!==e&&(l=l[e])}),i&&l&&e.addEventListener(i,function(){l.call(t)},!1)}}]),n}(),a=function(){function a(e){t(this,a),this.$fragment=e}return e(a,[{key:"_getVMVal",value:function(e,t){var n=e;return t.replace("()","").split(".").forEach(function(e){"this"!==e&&(n=n[e])}),n}},{key:"_getVMRepeatVal",value:function(e,t){var n=t.split(" ");return this._getVMVal(e,n[3])}},{key:"_setVMVal",value:function(e,t,n){var a=e;(t=t.split(".")).forEach(function(e,i){i<t.length-1?a=a[e]:a[e]=n})}},{key:"text",value:function(e,t,n){this.bind(e,t,n,"text")}},{key:"bind",value:function(e,t,n,a){var i=this[a+"Updater"],r=this.isRepeatNode(e);switch(a){case"model":!r&&i&&i.call(this,e,this._getVMVal(t,n),n,t);break;case"repeat":r&&i&&i.call(this,e,this._getVMRepeatVal(t,n),n,t);break;default:!r&&i&&i.call(this,e,this._getVMVal(t,n))}}},{key:"textUpdater",value:function(e,t){e.textContent=void 0===t?"":t}},{key:"htmlUpdater",value:function(e,t){e.innerHTML=void 0===t?"":t}},{key:"classUpdater",value:function(e,t,n){var a=e.className,i=(a=a.replace(n,"").replace(/\s$/,""))&&String(t)?" ":"";e.className=a+i+t}},{key:"modelUpdater",value:function(e,t,n,a){e.value=void 0===t?"":t;var i=n.replace(/(this.state.)|(this.props)/,"");e.addEventListener("change",function(){/(this.state.).*/.test(n)&&(a.state[i]=e.value),/(this.props.).*/.test(n)&&(a.props[i]=e.value)},!1)}},{key:"repeatUpdater",value:function(e,t,a,i){var r=this,l=a.split(" ")[1],o=a.split(" ")[3];t.forEach(function(t,a){var s=e.cloneNode(!0),c=s.attributes;c&&Array.from(c).forEach(function(e){var c=e.name;if(r.isDirective(c)&&"es-repeat"!==c){var u=c.substring(3),v=e.value;r.isEventDirective(u)?(new n).eventHandler(s,i,v,u):(new n).bind(s,t,l,u,v,a,i,o)}}),r.$fragment.appendChild(s)})}},{key:"isDirective",value:function(e){return 0===e.indexOf("es-")}},{key:"isEventDirective",value:function(e){return 0===e.indexOf("on")}},{key:"isElementNode",value:function(e){return 1===e.nodeType}},{key:"isRepeatNode",value:function(e){var t=e.attributes,n=!1;return t&&Array.from(t).forEach(function(e){"es-repeat"===e.name&&(n=!0)}),n}}]),a}(),i=function(){function n(e,a){t(this,n),this.$vm=a,this.$el=this.isElementNode(e)?e:document.querySelector(e),this.$el&&(this.$fragment=this.node2Fragment(this.$el),this.init(),this.$el.appendChild(this.$fragment))}return e(n,[{key:"init",value:function(){this.compileElement(this.$fragment)}},{key:"compileElement",value:function(e){var t=this,n=document.createElement("div");n.innerHTML=this.$vm.declareTemplate;var a=n.childNodes;Array.from(a).forEach(function(n){var a=n.textContent;t.isElementNode(n)&&(t.compile(n),/\{\{(.*)\}\}/g.test(a)&&t.compileText(n,RegExp.$1)),t.isRepeatNode(n)||e.appendChild(n)})}},{key:"compile",value:function(e){var t=this,n=e.attributes;n&&Array.from(n).forEach(function(n){var i=n.name;if(t.isDirective(i)){var r=i.substring(3),l=n.value;t.isEventDirective(r)?t.eventHandler(e,t.$vm,l,r):new a(t.$fragment).bind(e,t.$vm,l,r)}})}},{key:"node2Fragment",value:function(e){for(var t=document.createDocumentFragment();void 0===e.firstChild;)t.appendChild(void 0);return t}},{key:"compileText",value:function(e,t){new a(this.$fragment).text(e,this.$vm,t)}},{key:"eventHandler",value:function(e,t,n,i){var r=new a,l=i.split(":")[1],o=n.replace(/\(.*\)/,"").split("."),s=n.match(/\((.*)\)/)[1].replace(/ /g,"").split(","),c=t;o.forEach(function(e){"this"!==e&&(c=c[e])});l&&c&&e.addEventListener(l,function(e){var n=[];s.forEach(function(a){if(""===a)return!1;console.log("arg",a),"$event"===a&&n.push(e),/(this.state.).*/g.test(a)&&n.push(r._getVMVal(t,a))}),console.log("argsList",n),c.call(t)},!1)}},{key:"isDirective",value:function(e){return 0===e.indexOf("es-")}},{key:"isEventDirective",value:function(e){return 0===e.indexOf("on")}},{key:"isElementNode",value:function(e){return 1===e.nodeType}},{key:"isRepeatNode",value:function(e){var t=e.attributes,n=!1;return t&&Array.from(t).forEach(function(e){"es-repeat"===e.name&&(n=!0)}),n}}]),n}();module.exports=i;
},{}],6:[function(require,module,exports) {
var e=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}}();function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=require("./Lifecycle"),n=require("./Compile"),s=require("./Watcher"),a=function(a){function p(e,o){t(this,p);var i=r(this,(p.__proto__||Object.getPrototypeOf(p)).call(this));return i.declareTemplateName=e,o&&(i.preProps=o,i.props={}),i.declareTemplate="",i.state={},i.fatherController={},i}return o(p,i),e(p,[{key:"$initProps",value:function(e){if(e)for(var t in this.preProps=e,this.props={},this.fatherController=window.routerController.declareComponents[this.declareTemplateName].preProps,this.fatherController)"string"==typeof this.preProps[t]&&(this.props[t]=window.routerController.state[this.fatherController[t]]),this.utils.isFunction(this.preProps[t])&&(this.props[t]=this.preProps[t])}},{key:"$beforeInit",value:function(){this.preProps&&(this.$initProps(this.preProps),this.propsWatcher=new s(this.props,this.$watchState.bind(this),this.$updateProps.bind(this),this.$reRender.bind(this))),this.stateWatcher=new s(this.state,this.$watchState.bind(this),null,this.$reRender.bind(this))}},{key:"$updateProps",value:function(e,t){var r=this.preProps[e];window.routerController.state[r]=t}},{key:"$render",value:function(){var e=document.getElementById("component_"+this.declareTemplateName);if(e&&e.hasChildNodes())for(var t=e.childNodes,r=t.length-1;r>=0;r--)e.removeChild(t.item(r));this.compile=new n("#component_"+this.declareTemplateName,this),this.$hasRender&&this.$hasRender()}},{key:"$reRender",value:function(){var e=document.getElementById("component_"+this.declareTemplateName);if(e&&e.hasChildNodes())for(var t=e.childNodes,r=t.length-1;r>=0;r--)e.removeChild(t.item(r));this.$onDestory&&this.$onDestory(),this.compile=new n("#component_"+this.declareTemplateName,this),this.$hasRender&&this.$hasRender()}},{key:"setProps",value:function(e){if(this.preProps){if(e&&this.utils.isFunction(e)){var t=e();if(t&&t instanceof Object)for(var r in t)this.props[r]&&this.props[r]!==t[r]&&(this.props[r]=t[r])}if(e&&e instanceof Object)for(var o in e)this.props[o]&&this.props[o]!==e[o]&&(this.props[o]=e[o])}}}]),p}();module.exports=a;
},{"./Lifecycle":3,"./Compile":5,"./Watcher":4}],7:[function(require,module,exports) {
var e=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=require("./Lifecycle"),i=require("./Watcher"),s=require("./Compile"),a=function(a){function c(){t(this,c);var e=n(this,(c.__proto__||Object.getPrototypeOf(c)).call(this));return e.declareTemplate="",e.state={},e.declareComponents={},e}return o(c,r),e(c,[{key:"$beforeInit",value:function(){this.stateWatcher=new i(this.state,this.$watchState.bind(this),this.$updateProps.bind(this),this.$reRender.bind(this))}},{key:"$updateProps",value:function(e,t){for(var n in this.declareComponents){var o=this.declareComponents[n],r=null;for(var i in o.preProps)o.preProps[i]===e&&(r=i);r&&t!==o.props[r]&&(o.props[r]=t)}}},{key:"$mountComponent",value:function(){var e=this,t=function(t){e.declareComponents[t].$beforeInit&&e.declareComponents[t].$beforeInit(),e.declareComponents[t].$onInit&&e.declareComponents[t].$onInit();var n=new RegExp("(<)("+t+")(/>)","g");e.declareTemplate=e.declareTemplate.replace(n,function(){return'<div id="component_'+t+'"></div>'}),e.declareComponents[t].$beforeMount&&e.declareComponents[t].$beforeMount()};for(var n in this.declareComponents)t(n)}},{key:"$render",value:function(){var e=document.getElementById("root");if(e.hasChildNodes())for(var t=e.childNodes,n=t.length-1;n>=0;n--)e.removeChild(t.item(n));if(this.$mountComponent(),this.compile=new s("#root",this),this.declareComponents)for(var o in this.declareComponents)this.declareComponents[o].$render&&this.declareComponents[o].$render(),this.declareComponents[o].$afterMount&&this.declareComponents[o].$afterMount();this.$hasRender&&this.$hasRender()}},{key:"$reRender",value:function(){var e=document.getElementById("root");if(e.hasChildNodes()){for(var t=e.childNodes,n=t.length-1;n>=0;n--)e.removeChild(t.item(n));this.$onDestory&&this.$onDestory()}if(this.$mountComponent(),this.compile=new s("#root",this),this.declareComponents)for(var o in this.declareComponents)this.declareComponents[o].$reRender&&this.declareComponents[o].$reRender(),this.declareComponents[o].$afterMount&&this.declareComponents[o].$afterMount();this.$hasRender&&this.$hasRender()}}]),c}();module.exports=a;
},{"./Lifecycle":3,"./Watcher":4,"./Compile":5}],8:[function(require,module,exports) {
var e=function(){function e(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(r,t,o){return t&&e(r.prototype,t),o&&e(r,o),r}}();function r(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}var t=require("./Utils"),o=function(){function o(){r(this,o),this.routes={},this.currentUrl="",this.lastRoute=null,this.rootDom=null,this.utils=new t,window.addEventListener("load",this.refresh.bind(this),!1),window.addEventListener("hashchange",this.refresh.bind(this),!1)}return e(o,[{key:"$routeChange",value:function(e,r){}},{key:"init",value:function(e){var r=this;if(e&&e instanceof Array){e.forEach(function(e){if(!(e.path&&e.controller&&r.utils.isFunction(e.controller)))return console.error("need path or controller"),!1;r.route(e.path,e.controller)});var t=document.querySelector("#root");this.rootDom=t||null}else console.error("no routes exit")}},{key:"route",value:function(e,r){this.routes[e]=r||function(){}}},{key:"refresh",value:function(){var e=this;if(this.currentUrl=location.hash.slice(1)||"/",this.routes[this.currentUrl]){window.routerController&&(window.routerController.$onDestory&&window.routerController.$onDestory(),delete window.routerController);var r=new this.routes[this.currentUrl];window.routerController=r,r.$beforeInit&&r.$beforeInit(),r.$onInit&&r.$onInit(),this.renderController(r).then(function(){e.$routeChange(e.lastRoute,e.currentUrl),e.lastRoute=e.currentUrl}).catch(function(){console.error("route change failed")})}}},{key:"renderController",value:function(e){var r=e.declareTemplate;return r&&"string"==typeof r&&this.rootDom?(e.$beforeMount&&e.$beforeMount(),this.replaceDom(e).then(function(){e.$afterMount&&e.$afterMount()}),Promise.resolve()):(console.error("renderController failed: template or rootDom is not exit"),Promise.reject())}},{key:"replaceDom",value:function(e){return e.$render&&e.$render(),Promise.resolve()}}]),o}();module.exports=o;
},{"./Utils":2}],1:[function(require,module,exports) {
var e=require("./Utils"),r=require("./Lifecycle"),o=require("./Watcher"),i=require("./Compile"),l=require("./Component"),t=require("./Controller"),u=require("./Router");module.exports={Utils:e,Lifecycle:r,Watcher:o,Compile:i,Component:l,Controller:t,Router:u};
},{"./Utils":2,"./Lifecycle":3,"./Watcher":4,"./Compile":5,"./Component":6,"./Controller":7,"./Router":8}]},{},[1], null)
//# sourceMappingURL=/index.map